</div>
</main>

<footer class="main">
    <!-- <section class="section-padding footer-mid">
        <div class="container pt-15 pb-10">
            <div class="row">

                <div class="col">
                    <div class="widget-about font-md mb-md-3 mb-lg-3 mb-xl-0 wow animate__animated animate__fadeInUp" data-wow-delay="0">
                        <div class="logo mb-0">
                            <a href="index.php" class="mb-15"><img src="assets/imgs/theme/logo.png" height="60" alt="logo" /></a>
                        </div>
                        <ul class="contact-infor">
                            <li><img src="assets/imgs/theme/icons/icon-location.svg" alt="" /><strong>Address: </strong> <span>1305, 13th Floor, Satra Plaza, Plot No - 19/20, Sector 19D, Navi Mumbai, Maharashtra, India - 400703.</span></li>
                            <li><img src="assets/imgs/theme/icons/icon-contact.svg" alt="" /><strong>Call Us:</strong><span>+91 022 27833972</span></li>
                            <li><img src="assets/imgs/theme/icons/icon-email-2.svg" alt="" /><strong>Email:</strong><span>sales@ornettech.com</span></li>
                            <li><img src="assets/imgs/theme/icons/icon-clock.svg" alt="" /><strong>Hours:</strong><span>10:00 - 18:00, Mon - Sat</span></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-link-widget col wow animate__animated animate__fadeInUp" data-wow-delay=".1s">
                    <h4 class=" widget-title">Corportaion</h4>
                    <ul class="footer-list mb-sm-5 mb-md-0">
                        <li><a href="index.php?p=about-us">About Us</a></li>
                        <li><a href="index.php?p=faq">FAQ</a></li>
                        <li><a href="index.php?p=license-guideline">Guideline</a></li>
                        <li><a href="index.php?p=terms-and-condition">Terms &amp; Conditions</a></li>
                        <li><a href="index.php?p=locate-us">Locate Us</a></li>
                    </ul>
                </div>
                <div class="footer-link-widget col wow animate__animated animate__fadeInUp" data-wow-delay=".2s">
                    <h4 class="widget-title">Account</h4>
                    <ul class="footer-list mb-sm-5 mb-md-0">
                        <li><a href="index.php?p=my-account">My Account</a></li>
                        <li><a href="index.php?p=my-shop">My Shop</a></li>
                        <li><a href="index.php?p=license-objection">Objection</a></li>
                        <li><a href="index.php?p=license-helpline">Helpline</a></li>
                    </ul>
                </div>
                <div class="footer-link-widget col wow animate__animated animate__fadeInUp" data-wow-delay=".3s">
                    <h4 class="widget-title">Ward Officer</h4>
                    <ul class="footer-list mb-sm-5 mb-md-0">
                        <li><a href="index.php?p=categories">Shops Categories</a></li>
                        <li><a href="index.php?p=shops">Shops Surveyed</a></li>
                        <li><a href="index.php?p=licensee">Shops Licensee</a></li>
                        <li><a href="index.php?p=revenue-statistics">Revenue Statistics</a></li>
                          
                    </ul>
                </div>
                <div class="footer-link-widget col wow animate__animated animate__fadeInUp" data-wow-delay=".4s">
                    <h4 class="widget-title">Install App</h4>
                    <ul class="footer-list mb-sm-5 mb-md-0">
                          <div class="download-app">
                                <a href="#" class="hover-up mb-sm-2"><img src="assets/imgs/theme/google-play.jpg" alt="" /></a>
                                <img class="" src="assets/imgs/theme/payment-method.png" alt="" />
                          </div>
                    </ul>
                </div>
            </div>
    </section> -->
    <div class="container pb-10  wow animate__animated animate__fadeInUp" data-wow-delay="0">
        <div class="row align-items-center">
            <div class="col-12 mb-10">
                <div class="footer-bottom"></div>
            </div>
            <div class="col-xl-6 col-lg-6 col-md-6">
                <p class="font-sm mb-0">&copy; <?php echo date('Y'); ?> <strong
                        class="text-brand"><?php echo $_SESSION['SAL_ElectionName']; ?></strong> | Buddi Lane,
                    Naralibag, Chhatrapati Sambhajinagar Municipal Corporation, Maharashtra - 431001. </p>
            </div>
            <div class="col-xl-6 col-lg-6 col-md-6 text-end">
                <p class="font-sm mb-0"> Developed And Maintained By <a href="https://www.ornettech.com/"
                        target="_blank">ORNET Technologies Pvt. Ltd.</a></p>
            </div>
        </div>
    </div>
</footer>

<!-- Vendor JS-->
<script src="assets/js/vendor/modernizr-3.6.0.min.js"></script>
<script src="assets/js/vendor/jquery-3.6.0.min.js"></script>
<script src="assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
<script src="assets/js/vendor/bootstrap.bundle.min.js"></script>
<script src="assets/js/plugins/slick.js"></script>
<script src="assets/js/plugins/jquery.syotimer.min.js"></script>
<script src="assets/js/plugins/waypoints.js"></script>
<script src="assets/js/plugins/wow.js"></script>
<script src="assets/js/plugins/perfect-scrollbar.js"></script>
<script src="assets/js/plugins/magnific-popup.js"></script>
<script src="assets/js/plugins/select2.min.js"></script>
<script src="assets/js/plugins/counterup.js"></script>
<script src="assets/js/plugins/jquery.countdown.min.js"></script>
<script src="assets/js/plugins/images-loaded.js"></script>
<script src="assets/js/plugins/isotope.js"></script>
<script src="assets/js/plugins/scrollup.js"></script>
<script src="assets/js/plugins/jquery.vticker-min.js"></script>
<script src="assets/js/plugins/jquery.theia.sticky.js"></script>
<script src="assets/js/plugins/jquery.elevatezoom.js"></script>
<script src="assets/js/invoice/jspdf.min.js"></script>
<script src="assets/js/invoice/invoice.js"></script>

<script src="assets/js/tables/datatable/pdfmake.min.js"></script>
<script src="assets/js/tables/datatable/vfs_fonts.js"></script>
<script src="assets/js/tables/datatable/datatables.min.js"></script>
<script src="assets/js/tables/datatable/datatables.buttons.min.js"></script>
<script src="assets/js/tables/datatable/buttons.html5.min.js"></script>
<script src="assets/js/tables/datatable/buttons.print.min.js"></script>
<script src="assets/js/tables/datatable/buttons.bootstrap.min.js"></script>
<script src="assets/js/tables/datatable/datatables.bootstrap4.min.js"></script>

<script src="assets/js/tables/datatable/dataTables.select.min.js"></script>
<script src="assets/js/tables/datatable/datatables.checkboxes.min.js"></script>


<!-- <script src="assets/js/plugins/apexcharts.min.js"></script> -->
<!-- Template  JS -->
<script src="assets/js/main.js?v=5.3"></script>
<script src="assets/js/shop.js?v=5.3"></script>

<script src="assets/js/select/select2.full.min.js"></script>
<script src="assets/js/select/select2.js"></script>
<script src="assets/js/scripts/datatables/datatable.js"></script>

<script>
    // $('.zero-configuration').DataTable();
</script>

<script type="text/javascript">
    $(document).ready(function () {
        document.getElementById("spinnerImage").style.marginRight = "0px;";
        document.getElementById("spinnerImage").style.marginLeft = "0px;";
        document.getElementById("spinnerImage").style.marginTop = "0px;";
        document.getElementById("spinnerImage").style.display = "none;";
        document.getElementById("spinnerLoader1").style.display = "block";
        document.getElementById("spinnerImage").style.display = "none";
        document.getElementById("bodyId").style.display = "block";
    });
</script>

<script type="text/javascript">

    $(document).ready(function () {
        "use strict"
        var dataListView = $('#data-list-view1').DataTable({
            responsive: true,
            columnDefs: [
                {
                    orderable: false,
                    targets: 0,
                }
            ],
            oLanguage: {
                sLengthMenu: "_MENU_",
                sSearch: ""
            },
            // aLengthMenu: [[1, 4, 10, 15, 20], [1, 4, 10, 15, 20]],
            searching: false,
            order: [[0, "asc"]],
            bInfo: false,
            lengthChange: false,
            ordering: false,
            info: false,
            pageLength: 5,
            paging: false,
            iDisplayLength: 5
        });

        var dataList10Paging = $('.table-10').DataTable({
            responsive: true,
            columnDefs: [
                {
                    orderable: false,
                    targets: 0,
                }
            ],
            oLanguage: {
                sLengthMenu: "_MENU_",
                sSearch: ""
            },
            // aLengthMenu: [[1, 4, 10, 15, 20], [1, 4, 10, 15, 20]],
            searching: false,
            order: [[0, "asc"]],
            bInfo: false,
            lengthChange: false,
            ordering: false,
            info: false,
            pageLength: 10,
            paging: true,
            iDisplayLength: 10
        });

        var dataList10Paging = $('.table-6').DataTable({
            responsive: true,
            columnDefs: [
                {
                    orderable: false,
                    targets: 0,
                }
            ],
            oLanguage: {
                sLengthMenu: "_MENU_",
                sSearch: ""
            },
            // aLengthMenu: [[1, 4, 10, 15, 20], [1, 4, 10, 15, 20]],
            searching: false,
            order: [[0, "asc"]],
            bInfo: false,
            lengthChange: false,
            ordering: false,
            info: false,
            pageLength: 6,
            paging: true,
            iDisplayLength: 6
        });

    });
</script>



<!-- Shop Details Form  Modal Start -->

<style>
    .nav-tabs .nav-item {
        margin: 5px 5px 5px 5px;
        padding: 10px;
        cursor: pointer;
    }

    .nav-tabs .nav-item:hover,
    .nav-tabs .nav-item.active {
        border-bottom: 1px solid #C90D41;
    }
</style>
<div class="modal fade" id="ShopModal" tabindex="-1" aria-labelledby="ShopModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document" style="max-width: 70vw;">
        <div class="modal-content">
            <div class="modal-header d-flex justify-content-between align-items-center mx-1 mx-sm-3 mb-0 pb-0 border-0">
                <!-- Nav Tabs -->
                <ul class="nav nav-tabs mb-0" id="progressbar" role="tablist">
                    <li class="nav-item active" id="application-details-tab">
                        <a class="nav-link" id="application-details-tab-link" data-toggle="tab"
                            href="#application-details-content"> Page 1 :Application Details</a>
                    </li>
                    <li class="nav-item" id="shop-details-tab">
                        <a class="nav-link" id="shop-details-tab-link" data-toggle="tab" href="#shop-details-content">
                            Page 2 : Shop Details</a>
                    </li>
                    <li class="nav-item" id="shop-documents-tab">
                        <a class="nav-link" id="shop-documents-tab-link" data-toggle="tab"
                            href="#shop-documents-content"> Page 3 : Shop Documents</a>
                    </li>
                </ul>
                <!-- Close Button -->
                <button type="button" class="btn-close p-3" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="ShopModal">
                    <div class="container">

                        <div class="tab-content">
                            <!-- Application Details Content -->
                            <div class="tab-pane active" id="application-details-content">
                                <h3 class="m-2">Application Details</h3>
                                <form id="application-form">
                                    <input type="hidden" class="form-control" id="shop_cd" name="shop_cd">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="title">Title <span class="required">*</span></label>
                                                <select class="select2 form-control" name="title" id="shopkeeper_title">
                                                    <option value="">--Select--</option>
                                                    <option value="Mrs">Mrs</option>
                                                    <option value="Mr">Mr</option>
                                                    <option value="Miss">Miss</option>
                                                </select>
                                            </div>
                                            <span id="shopkeeper_title-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="first-name">First Name <span
                                                        class="required">*</span></label>
                                                <input type="text" class="form-control" id="shopkeeper_firstname"
                                                    name="firstname" placeholder="Enter your First Name"
                                                    oninput="this.value=this.value.replace(/[^a-zA-Z\d\s]|(?<=\S)\s{2,}/g, '').replace(/\s{2,}/g, ' ').trim(); this.value = this.value.charAt(0).toUpperCase() + this.value.slice(1);"
                                                    onkeyup="getFullName()">
                                            </div>
                                            <span id="shopkeeper_firstname-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="parentname">Father's Name/Husband Name</label>
                                                <input type="text" class="form-control" id="shopkeeper_parentname"
                                                    name="parentname" placeholder="Enter your Father's Name"
                                                    oninput="this.value=this.value.replace(/[^a-zA-Z\d\s]|(?<=\S)\s{2,}/g, '').replace(/\s{2,}/g, ' ').trim(); this.value = this.value.charAt(0).toUpperCase() + this.value.slice(1);"
                                                    onkeyup="getFullName()">
                                            </div>
                                            <span id="shopkeeper_parentname-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="surname">SurName <span class="required">*</span></label>
                                                <input type="text" class="form-control" id="shopkeeper_surname"
                                                    name="surname" placeholder="Enter your SurName"
                                                    oninput="this.value=this.value.replace(/[^a-zA-Z\d\s]|(?<=\S)\s{2,}/g, '').replace(/\s{2,}/g, ' ').trim(); this.value = this.value.charAt(0).toUpperCase() + this.value.slice(1);"
                                                    onkeyup="getFullName()">
                                            </div>
                                            <span id="shopkeeper_surname-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="fullname">Full Name <span class="required">*</span></label>
                                                <input type="text" class="form-control" id="shopkeeper_fullname"
                                                    name="fullname" placeholder="Enter your Full Name" readonly>
                                            </div>
                                            <span id="shopkeeper_fullname-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group ">
                                                <label for="mobile" class="mr-2">Mobile <span
                                                        class="required">*</span></label>
                                                <div class="d-flex align-items-center">
                                                    <input type="text" class="form-control" id="shopkeeper_mobile"
                                                        name="mobile" placeholder="Enter your Mobile"
                                                        oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0, 10);">

                                                    <button type="button" class="btn btn-primary btn-sm ml-5"
                                                        id="verifyOtpBtn"
                                                        style="display: none;font-size: 8px">Get OTP</button>
                                                    <input type="text" class="form-control ml-5" id="otpvalue"
                                                        name="otpvalue" placeholder="Enter your OTP" oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0, 4);"
                                                        onkeyup="validateMobileNo()" style="display: none;">
                                                </div>

                                            </div>
                                        </div>


                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="email">Email <span class="required">*</span></label>
                                                <input type="email" class="form-control" id="shopkeeper_email"
                                                    name="email" placeholder="Enter your Email"
                                                    onblur="validateEmailInput(this)">
                                            </div>
                                            <span id="shopkeeper_email-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="aadharno">Aadhar No</label>
                                                <input type="text" class="form-control" id="shopkeeper_aadharno"
                                                    name="aadharno" placeholder="Enter your Aadhar No"
                                                    oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0, 12);">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="address">Address For Correspondance <span
                                                        class="required">*</span></label>
                                                <textarea class="form-control" id="shopkeeper_address"
                                                    name="address"></textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="pincode">Pincode <span class="required">*</span></label>
                                                <input type="text" class="form-control" id="shopkeeper_pincode"
                                                    name="pincode" placeholder="Enter your Pincode"
                                                    oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0, 6);">
                                            </div>
                                            <span id="shopkeeper_pincode-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                    </div>

                                    <button type="button" class="btn btn-primary m-3" style="float: right;"
                                        onclick="submitForm('application-form')">Next</button>
                                    <div class="form-group">
                                        <div id="submitmsg" style="display: none;">
                                            <img height="50" width="50" src="assets/imgs/loader/loading.gif" />
                                        </div>
                                        <div id="submitmsgsuccess" class="controls alert alert-success" role="alert"
                                            style="display: none;"></div>
                                        <div id="submitmsgfailed" class="controls alert alert-danger" role="alert"
                                            style="display: none;"></div>
                                    </div>
                                </form>
                            </div>

                            <div class="tab-pane" id="shop-details-content">
                                <h3 class="m-2">Shop Details</h3>
                                <form id="shop-details-form">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="shopcategory">Shop Category<span
                                                        class="required">*</span></label>
                                                <select class="select2 form-control" id="shopcategory"
                                                    name="shopcategory">
                                                    <option value="">--Select--</option>
                                                </select>
                                            </div>
                                            <span id="shopcategory-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="businesscategory">Business Category<span
                                                        class="required">*</span></label>
                                                <select class="select2 form-control" id="businesscategory"
                                                    name="businesscategory">
                                                    <option value="">--Select--</option>
                                                </select>
                                            </div>
                                            <span id="businesscategory-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="nameofbusiness">Name Of Business <span
                                                        class="required">*</span></label>
                                                <input type="text" class="form-control" id="nameofbusiness"
                                                    name="nameofbusiness" placeholder="Enter your Name of Business"
                                                    oninput="this.value=this.value.replace(/[^a-zA-Z\d\s]|(?<=\S)\s{2,}/g, '').replace(/\s{2,}/g, ' ')">
                                            </div>
                                            <span id="nameofbusiness-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="businessdetails">Business Details <span
                                                        class="required">*</span></label>
                                                <select class="select2 form-control" name="businessdetails"
                                                    id="businessdetails" onchange="getAmount()">
                                                    <option value="">--Select--</option>
                                                </select>
                                            </div>
                                            <span id="businessdetails-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                    </div>

                                    <div class="row">

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="spacetype">Space Type <span
                                                        class="required">*</span></label>
                                                <select class="select2 form-control" id="spacetype" name="spacetype">
                                                    <option value="">--Select--</option>

                                                </select>
                                            </div>
                                            <span id="spacetype-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="shopownstatus">Shop Own Status</label>
                                                <select class="select2 form-control" id="shopownstatus"
                                                    name="shopownstatus">
                                                    <option value="">--Select--</option>
                                                    <option value="Rented">Rent</option>
                                                    <option value="own">Own</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="estdate">Estimate Date to Start New Business <span
                                                        class="required">*</span></label>
                                                <input type="Date" class="form-control" id="estimatedate"
                                                    name="estimatedate">
                                            </div>
                                            <span id="estimatedate-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="ShopOwnPeriod">Shop Own Period (in months)<span
                                                        class="required">*</span></label>
                                                <input type="text" class="form-control" id="ShopOwnPeriod"
                                                    name="ShopOwnPeriod" readonly>
                                            </div>
                                            <span id="ShopOwnPeriod-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                    </div>

                                    <!-- <br> -->

                                    <h5 class="m-2">Shop Dimension</h5>

                                    <div class="row">
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="length">Length (in Meters)<span
                                                        class="required">*</span></label>
                                                <input type="text" class="form-control" id="shoplength" name="length"
                                                    oninput="this.value = this.value.replace(/\D/g, '')">
                                            </div>
                                            <span id="shoplength-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="width">Width (in Meters)<span
                                                        class="required">*</span></label>
                                                <input type="text" class="form-control" id="shopwidth" name="width"
                                                    oninput="this.value = this.value.replace(/\D/g, '')">
                                            </div>
                                            <span id="shopwidth-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="height">Height (in Meters)<span
                                                        class="required">*</span></label>
                                                <input type="text" class="form-control" id="shopheight" name="height"
                                                    oninput="this.value = this.value.replace(/\D/g, '')">
                                            </div>
                                            <span id="shopheight-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>

                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="zoneno">Zone No</label>
                                                <select class="select2 form-control" id="zoneno" name="zoneno">
                                                    <option value="">--Select--</option>
                                                    <?php
                                                    // session_start();
                                                    $electionName = $_SESSION['SAL_ElectionName'];
                                                    $developmentMode = $_SESSION['SAL_DevelopmentMode'];
                                                    $sql1 = " SELECT DISTINCT(NodeName) as NodeName FROM NodeMaster WHERE IsActive = 1;";
                                                    $db3 = new DbOperation();
                                                    $zone = $db3->ExecutveQueryMultipleRowSALData($sql1, $electionName, $developmentMode);
                                                    if ($zone) {
                                                        foreach ($zone as $node) {
                                                            echo "<option value='" . htmlspecialchars($node['NodeName']) . "'>" . htmlspecialchars($node['NodeName']) . "</option>";
                                                        }
                                                    }
                                                    ?>
                                                </select>
                                            </div>
                                            <span id="zoneno-error" class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="wardno">Ward No</label>
                                                <select class="select2 form-control" id="wardno" name="wardno">
                                                </select>
                                            </div>
                                            <span id="wardno-error" class="text-danger error-below-form-fields"></span>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="area">Area <span class="required">*</span></label>
                                                <input type="text" class="form-control" id="shoparea" name="area"
                                                    oninput="this.value=this.value.replace(/[^a-zA-Z\d\s]|(?<=\S)\s{2,}/g, '').replace(/\s{2,}/g, ' ').trim(); this.value = this.value.charAt(0).toUpperCase() + this.value.slice(1);">
                                            </div>
                                            <span id="shoparea-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="address">Shop Address For Correspondance <span
                                                        class="required">*</span></label>
                                                <textarea class="form-control" id="shopaddress"
                                                    name="address"></textarea>
                                            </div>
                                            <span id="shopaddress-error"
                                                class="text-danger error-below-form-fields"></span>
                                        </div>

                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="shopfees"> Fees Applicable <span
                                                        class="required">*</span></label>
                                                <input type="text" class="form-control" id="shopfees" name="shopfees"
                                                    readonly></b>
                                            </div>
                                        </div>

                                    </div>
                                    <button type="button" class="btn btn-primary m-3" style="float: right;"
                                        onclick="submitForm('shop-details-form')">Next</button>
                                    <div id="submitmsgsuccess" class="controls alert alert-success" role="alert"
                                        style="display: none;"></div>
                                    <div id="submitmsgfailed" class="controls alert alert-danger" role="alert"
                                        style="display: none;"></div>
                                </form>
                            </div>
                            <div class="tab-pane" id="shop-documents-content">
                                <h3 class="m-2">Shop Documents</h3>
                                <?php
                                $electionName = $_SESSION['SAL_ElectionName'];
                                $developmentMode = $_SESSION['SAL_DevelopmentMode'];
                                $sql = "SELECT Document_Cd,DocumentName,DocumentNameMar, DocumentType,IsCompulsory FROM ShopDocumentMaster WHERE IsActive = 1";
                                $dbdoc = new DbOperation();
                                $docType = $dbdoc->ExecutveQueryMultipleRowSALData($sql, $electionName, $developmentMode);
                                ?>
                                <form id="shopDocForm">
                                    <div class="row">
                                        <?php foreach ($docType as $key => $doc) { ?>

                                            <input type="hidden" name="is_compulsory[]" id="is_compulsory_<?= $key ?>"
                                                value="<?= $doc['IsCompulsory'] ?>">
                                            <input type="hidden" name="document_type[]" id="document_type_<?= $key ?>"
                                                value="<?= $doc['DocumentType'] ?>">
                                            <input type="hidden" name="document_cd[]" id="document_cd_<?= $key ?>"
                                                value="<?= $doc['Document_Cd'] ?>">

                                            <input type="hidden" name="ShopDocDet_Cd[]"
                                                id="ShopDocDet_Cd_<?= $doc['Document_Cd'] ?>">

                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label for="file"><?= $doc['DocumentName'] ?> (
                                                        <?= $doc['DocumentNameMar'] ?> )
                                                        <?php if ($doc['IsCompulsory'] == 1) { ?> <span
                                                                class="required">*</span> <?php } ?>
                                                    </label>
                                                    <div class="d-flex align-items-center">

                                                        <?php if ($doc['DocumentType'] == 'image') {
                                                            $accept = 'image/jpeg, image/png, image/jpg';
                                                        } else {
                                                            $accept = 'application/pdf';
                                                        }
                                                        ?>
                                                        <input type="file" class="form-control"
                                                            id="file_<?= $doc['Document_Cd'] ?>" name="file[]"
                                                            accept="<?= $accept ?>">

                                                        <input type="hidden" name="file_url[]"
                                                            id="file_url_<?= $doc['Document_Cd'] ?>">

                                                        <a href="" id="FileTag_<?= $doc['Document_Cd'] ?>"
                                                            class="btn btn-info shadow btn-sm sharp file-btn mr-1 m-2 d-none"
                                                            target="_blank">
                                                            <i class="fa fa-file"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <span id="file_<?= $doc['Document_Cd'] ?>-error"
                                                    class="text-danger error-below-form-fields"></span>
                                            </div>
                                        <?php } ?>
                                    </div>
                                </form>

                                <div class="docList d-none">

                                </div>

                                <div class="col-md-12 btn-div">
                                    <button type="button" class="btn btn-primary m-3" id="upload_btn" style="float: right;"
                                        onclick="submitForm('shopDocForm')">Submit</button>
                                    <div id="submitmsgsuccess" class="controls alert alert-success" role="alert"
                                        style="display: none;"></div>
                                    <div id="submitmsgfailed" class="controls alert alert-danger" role="alert"
                                        style="display: none;"></div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--  Shop Details Form Modal End  -->

<!-- shop Modal Script -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- New Shop Owner Shop Details Start -->


    <script>
        let globBusinessDetailCd = 0;
        let globalWardNo = 0;
        let globalSpaceType = 0;

        function redirectToEditPage(Shop_Cd) {
            // alert('hello');
            $.ajax({
                url: './action/getShopAddressDetails.php',
                type: 'POST',
                data: {
                    Shop_Cd: Shop_Cd
                },
                success: function(response) {
                    var data = JSON.parse(response);
                    if (data.status == 200) {
                        var records = data.data[0];
                        var ShopKeeperName = records['ShopKeeperName'];
                        var nameParts = ShopKeeperName.split(' ');
                        var firstName = '';
                        var middleName = '';
                        var lastName = '';
                        if (records['FirstName'] != '' && records['LastName'] != '') {
                            firstName = records['FirstName'];
                            lastName = records['LastName'];
                            if (records['MiddleName'] != '') {
                                middleName = records['MiddleName'];
                            }
                        } else if (nameParts.length == 3) {
                            firstName = nameParts[0];
                            middleName = nameParts[1];
                            lastName = nameParts[2];
                        } else if (nameParts.length > 3) {
                            firstName = nameParts[0];
                            lastName = nameParts[nameParts.length - 1];
                            middleName = nameParts.slice(1, nameParts.length - 1).join(' ');

                        } else {
                            firstName = nameParts[0];
                            lastName = nameParts[1];
                        }

                        $('#shopkeeper_title').val(records['Title'].trim()).trigger('change');
                        $('#shopkeeper_fullname').val(records['ShopKeeperName']);
                        $('#shopkeeper_firstname').val(firstName);
                        $('#shopkeeper_parentname').val(middleName);
                        $('#shopkeeper_surname').val(lastName);
                        $('#shopkeeper_mobile').val(records['ShopKeeperMobile']);
                        $('#shopkeeper_email').val(records['ShopEmailAddress']);
                        $('#shopkeeper_aadharno').val(records['ShopOwnerAadharNo']);
                        $('#shopkeeper_address').val(records['ShopOwnerAddress']);
                        $('#shopkeeper_pincode').val(records['ShopOwnerPinCode']);
                        $('#shop_cd').val(Shop_Cd);
                        $('#shopkeeper_mobile').prop('readonly', true);
                        $('#verifyOtpBtn').hide();
                        $('#ShopModal').modal('show');
                        setTimeout(function() {
                            if ($('.nav-item').has('active')) {
                                $('.nav-item').removeClass('active');
                            }
                            $('#application-details-tab').addClass('active');
                            $('#application-details-tab-link').tab('show');
                            updateNavLinks();
                        }, 200);
                    } else {
                        alert(data.message);
                    }
                },
                error: function(xhr, status, error) {
                    console.error("Error: " + error);
                }
            });
        }

        function getFullName() {
            var firstname = $('#shopkeeper_firstname').val();
            var middlename = $('#shopkeeper_parentname').val();
            var surname = $('#shopkeeper_surname').val();

            let fullName = firstname;
            if (middlename) {
                fullName += ' ' + middlename;
            }

            if (surname) {
                fullName += ' ' + surname;
            }

            $('#shopkeeper_fullname').val(fullName);
        }

        function submitForm(form_id) {
            if (form_id == 'application-form') {
                let hasError = false;

                const fields = [{
                        id: 'shopkeeper_title',
                        errorId: 'shopkeeper_title-error',
                        message: 'Title is required'
                    },
                    {
                        id: 'shopkeeper_firstname',
                        errorId: 'shopkeeper_firstname-error',
                        message: 'First Name is required'
                    },
                    {
                        id: 'shopkeeper_surname',
                        errorId: 'shopkeeper_surname-error',
                        message: 'Surname is required'
                    },
                    {
                        id: 'shopkeeper_mobile',
                        errorId: 'shopkeeper_mobile-error',
                        message: 'Mobile Number is required'
                    },
                    {
                        id: 'shopkeeper_email',
                        errorId: 'shopkeeper_email-error',
                        message: 'Email is required'
                    },
                    {
                        id: 'shopkeeper_pincode',
                        errorId: 'shopkeeper_pincode-error',
                        message: 'Pincode is required'
                    },
                    {
                        id: 'shopkeeper_address',
                        errorId: 'shopkeeper_address-error',
                        message: 'Address is required'
                    },
                ];

                fields.forEach(field => {
                    const value = $('#' + field.id).val();
                    if (value == '' || value == null) {
                        $('#' + field.errorId).text(field.message);
                        hasError = true;
                    } else {
                        if (field.id == 'shopkeeper_mobile') {
                            const mobileRegex = /^[0-9]{10}$/;
                            if (!mobileRegex.test(value)) {
                                $('#' + field.errorId).text('Mobile Number must be 10 digits');
                                hasError = true;
                                return;
                            }
                        }
                        if (field.id == 'shopkeeper_pincode') {
                            const pincodeRegex = /^[0-9]{6}$/;
                            if (!pincodeRegex.test(value)) {
                                $('#' + field.errorId).text('Pincode must be 6 digits');
                                hasError = true;
                                return;
                            }
                        }
                        $('#' + field.errorId).text('');
                    }
                });

                var aadhar_no = $('#shopkeeper_aadhar_no').val();

                if (aadhar_no && aadhar_no.length != 12) {
                    $('#shopkeeper_aadharno-error').text('Aadhar Number must be 12 digits');
                    hasError = true;
                    return;
                }

                if ($('#verifyOtpBtn').is(':visible')) {
                    $('#shopkeeper_mobile-error').text('Please Verify Mobile No');
                    hasError = true;
                    return;
                }

                if (!hasError) {
                    submitApplicationForm(form_id);
                }
            } else if (form_id == 'shop-details-form') {
                let hasError = false;
                const fields = [{
                        id: 'shopcategory',
                        errorId: 'shopcategory-error',
                        message: 'Shop Category is required'
                    },
                    {
                        id: 'businesscategory',
                        errorId: 'businesscategory-error',
                        message: 'Business Category is required'
                    },
                    {
                        id: 'businessdetails',
                        errorId: 'businessdetails-error',
                        message: 'Business Details is required'
                    },
                    {
                        id: 'nameofbusiness',
                        errorId: 'nameofbusiness-error',
                        message: 'Business Name is required'
                    },
                    {
                        id: 'estimatedate',
                        errorId: 'estimatedate-error',
                        message: 'Estimate Date is required'
                    },
                    {
                        id: 'spacetype',
                        errorId: 'spacetype-error',
                        message: 'Space Type is required'
                    },
                    {
                        id: 'shopownstatus',
                        errorId: 'shopownstatus-error',
                        message: 'Shop Own Status is required'
                    },
                    {
                        id: 'shoplength',
                        errorId: 'shoplength-error',
                        message: 'Shop Length is required'
                    },
                    {
                        id: 'shopheight',
                        errorId: 'shopheight-error',
                        message: 'Shop Height is required'
                    },
                    {
                        id: 'shopwidth',
                        errorId: 'shopwidth-error',
                        message: 'Shop Width is required'
                    },
                    {
                        id: 'shopaddress',
                        errorId: 'shopaddress-error',
                        message: 'Shop Address is required'
                    },
                    {
                        id: 'shoparea',
                        errorId: 'shoparea-error',
                        message: 'Shop Area is required'
                    }
                ];

                fields.forEach(field => {
                    const value = $('#' + field.id).val();
                    if (value == '' || value == null) {
                        $('#' + field.errorId).text(field.message);
                        hasError = true;
                    } else {
                        if (field.id == 'shoplength') {
                            if (value == 0) {
                                $('#' + field.errorId).text('Shop Length should be greater than 0');
                                hasError = true;
                                return;
                            }
                        }

                        if (field.id == 'shopheight') {
                            if (value == 0) {
                                $('#' + field.errorId).text('Shop Height should be greater than 0');
                                hasError = true;
                                return;
                            }
                        }

                        if (field.id == 'shopwidth') {
                            if (value == 0) {
                                $('#' + field.errorId).text('Shop Width should be greater than 0');
                                hasError = true;
                                return;
                            }
                        }
                        $('#' + field.errorId).text('');
                    }
                });

                var zoneno = $('#zoneno').val();
                var wardno = $('#wardno').val();

                if (zoneno && zoneno !== '0') {
                    if (!wardno) {
                        $('#wardno-error').text('Ward No is required');
                        hasError = true;
                    }
                }

                if (!hasError) {
                    submitShopDetails(form_id);
                }



            } else if (form_id == 'shopDocForm') {
                SubmitDocumentForm(form_id);
            }
        }


        function submitApplicationForm(form_id) {
            var formData = $('#' + form_id).serialize();

            $.ajax({
                url: 'action/save_ApplicationForm.php',
                type: 'POST',
                data: formData,
                beforeSend: function() {},
                success: function(response) {
                    var data = JSON.parse(response);
                    if (data.status === 'success') {
                        $("#submitmsgsuccess").html(data.message)
                            .hide().fadeIn(800, function() {
                                $("submitmsgsuccess").append("");

                            }).delay(3000).fadeOut("fast");
                        if (data.Shop_Cd) {
                            $('#shop_cd').val(data.Shop_Cd);
                        }
                        get_ShopDetails();
                        setTimeout(function() {
                            if ($('.nav-item').has('active')) {
                                $('.nav-item').removeClass('active');
                            }
                            $('#shop-details-tab').addClass('active');
                            $('#shop-details-tab-link').tab('show');
                            updateNavLinks();
                        }, 2500);
                    } else {
                        $("#submitmsgfailed").html(data.message)
                            .hide().fadeIn(800, function() {
                                $("submitmsgfailed").append("");
                            }).delay(3000).fadeOut("fast");
                    }
                },
                error: function(xhr, status, error) {
                    $('#submitmsgfailed').text('An error occurred. Please try again.').show();
                }
            });
        }


        function get_ShopDetails() {
            getShopCategory();
            getBusinessCategory();
            getSpaceType();
            var Shop_Cd = $('#shop_cd').val();
            $.ajax({
                url: 'action/getShopDetails.php',
                type: 'POST',
                data: {
                    shop_cd: Shop_Cd
                },
                success: function(response) {
                    var data = JSON.parse(response);
                    console.log(data);
                    globBusinessDetailCd = data.Parwana_Cd;
                    globalWardNo = data.Ward_No;
                    globalSpaceType = data.ShopArea_Cd;
                    // console.log(globalWardNo);
                    $('#ShopOwnPeriod').val("");

                    $('#nameofbusiness').val(data.ShopName);
                    $('#shopcategory').val(data.ShopCategory).trigger('change');
                    $('#businesscategory').val(data.BusinessCat_Cd).trigger('change');
                    $('#nameofbusiness').val(data.ShopName);
                    $('#businessdetails').val(globBusinessDetailCd).trigger('change');
                    $('#shopownstatus').val(data.ShopOwnStatus);
                    $('#spacetype').val(globalSpaceType).trigger('change');

                    if (data.BusinessStartDate != null && data.BusinessStartDate != '') {
                        $('#estimatedate').val(data.BusinessStartDate);
                    }
                    if (data.ShopOwnPeriod != null && data.ShopOwnPeriod != '') {
                        $('#ShopOwnPeriod').val(data.ShopOwnPeriod);
                    } else {
                        calculate_ShopOwnsPeriod(data.BusinessStartDate);
                    }

                    $('#shoplength').val(data.ShopLength);
                    $('#shopheight').val(data.ShopHeight);
                    $('#shopwidth').val(data.ShopWidth);
                    $('#shoparea').val(data.ShopArea_Name);
                    $('#shopaddress').val(data.ShopAddress_1);
                    $('#shopfees').val(data.Amount);
                    $('#zoneno').val(data.NodeName).trigger('change');
                    $('#wardno').val(globalWardNo).trigger('change');

                },
                error: function(xhr, status, error) {

                    $('#submitmsg').hide();
                    $('#submitmsgfailed').text('An error occurred while fetching the data.').show();
                }
            });
        }


        function submitShopDetails(form_id) {
            var formData = $('#' + form_id).serialize();
            let Shop_Cd = $('#shop_cd').val();
            formData += '&shop_cd=' + encodeURIComponent(Shop_Cd);
            $.ajax({
                url: 'action/save_ShopDetails.php',
                type: 'POST',
                data: formData,
                success: function(response) {
                    var data = JSON.parse(response);
                    if (data.status === 'success') {
                        $("#shop-details-form #submitmsgsuccess").html(data.message)
                            .hide().fadeIn(800, function() {
                                $("submitmsgsuccess").append("");
                            }).delay(3000).fadeOut("fast");
                        if (data.Shop_Cd) {
                            $('#shop_cd').val(data.Shop_Cd);
                        }
                        get_DocDetails();
                        setTimeout(function() {
                            if ($('.nav-item').has('active')) {
                                $('.nav-item').removeClass('active');
                            }
                            $('#shop-documents-tab').addClass('active');
                            $('#shop-documents-tab-link').tab('show');
                            updateNavLinks();
                        }, 200);
                    } else {
                        $("#submitmsgfailed").html(data.message)
                            .hide().fadeIn(800, function() {
                                $("submitmsgfailed").append("");
                            }).delay(3000).fadeOut("fast");
                    }
                },
                error: function(xhr, status, error) {

                    alert('An error occurred while saving the details.');
                    console.log(error);
                }
            });
        }

        $('#businesscategory').change(function() {
            // alert($(this).val());
            console.log($(this).val());
            var categoryCd = $(this).val();
            if (categoryCd) {

                $.ajax({
                    url: 'action/get_business_details.php',
                    type: 'POST',
                    data: {
                        businessCatCd: categoryCd
                    },
                    success: function(response) {
                        $('#businessdetails').html('<option value="">--Select--</option>');
                        if (response) {
                            var details = JSON.parse(
                                response);
                            $.each(details, function(index, detail) {
                                $('#businessdetails').append('<option value="' + detail
                                    .Parwana_Cd + '">' + detail.Parwana_Name_Eng +
                                    '</option>');
                            });
                        } else {
                            $('#businessdetails').append(
                                '<option value="">No details available</option>');
                        }
                        $('#businessdetails').val(globBusinessDetailCd).trigger('change');
                    },
                    error: function() {
                        alert('Error fetching business details.');
                    }
                });
            } else {
                $('#businessdetails').html('<option value="">--Select--</option>');
            }
        });

        $('#zoneno').on('change', function() {
            var zoneno = $(this).val();
            var nodeName = $('#zoneno option:selected').text();
            // alert(nodeName);
            $('#wardno').html('<option value="">--Select--</option>');

            if (zoneno) {
                $.ajax({
                    url: 'action/get_wards.php',
                    type: 'POST',
                    data: {
                        nodeName: nodeName
                    },
                    success: function(response) {
                        var wards = JSON.parse(response);
                        $.each(wards, function(index, ward) {
                            $('#wardno').append('<option value="' + ward.Ward_No +
                                '">' + ward.Ward_No + '</option>');
                        });
                        $('#wardno').val(globalWardNo).trigger('change');
                    },
                    error: function() {
                        alert('Error fetching ward data.');
                    }


                });
            }
        });


        function get_DocDetails() {
            var Shop_Cd = $('#shop_cd').val();
            $.ajax({
                url: 'action/getShopDocDetails.php',
                type: 'POST',
                data: {
                    Shop_Cd: Shop_Cd
                },
                success: function(response) {
                    var docDetails = JSON.parse(response);
                    docDetails = docDetails[0];
                    docDetails.forEach(doc => {
                        $(`#ShopDocDet_Cd${doc.Document_Cd}`).val(doc.ShopDocDet_Cd);
                        $(`#FileTag_${doc.Document_Cd}`).removeClass('d-none');
                        $(`#FileTag_${doc.Document_Cd}`).attr('href', doc.FileURL);
                        $(`#file_url_${doc.Document_Cd}`).val(doc.FileURL);
                    });
                    // $('.shopdocRow').append(newRow);
                },
                error: function() {
                    alert('Error fetching ward data.');
                }
            });
        }


        function getShopCategory() {
            $.ajax({
                url: 'action/getshopcategory.php',
                type: 'POST',
                success: function(response) {
                    const categories = JSON.parse(response);
                    const dropdown = $('#shopcategory');
                    dropdown.empty(); // Clear existing options
                    dropdown.append('<option value="">--Select--</option>'); // Default option

                    categories.forEach(category => {
                        // Corrected string interpolation
                        dropdown.append(`<option value="${category.DValue}">${category.DValue}</option>`);
                    });
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching data:', error);
                    $('#submitmsgfailed').text('An error occurred while fetching the data.').show();
                }
            });
        }

        function getBusinessCategory() {
            $.ajax({
                url: 'action/getbusinesscategory.php',
                type: 'POST',
                success: function(response) {
                    const categories = JSON.parse(response);
                    const dropdown = $('#businesscategory');
                    dropdown.empty();
                    dropdown.append('<option value="">--Select--</option>');

                    if (categories.length > 1) {
                        categories.forEach(category => {
                            dropdown.append(
                                `<option value="${category.BusinessCat_Cd}"> ${category.BusinessCatName} </option>`
                            );
                        });
                    }
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching data:', error);
                    $('#submitmsgfailed').text('An error occurred while fetching the data.').show();
                }
            });
        }

        function getSpaceType() {

            $.ajax({
                url: 'action/getSpaceType.php',
                type: 'POST',
                success: function(response) {
                    const types = JSON.parse(response);
                    const dropdown = $('#spacetype');
                    dropdown.empty();
                    dropdown.append('<option value="">--Select--</option>');

                    types.forEach(type => {
                        dropdown.append(
                            `<option value="${type.ShopArea_Cd}">${type.ShopAreaName}</option>`);
                    });
                    $('#spacetype').val(globalSpaceType).trigger('change');
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching data:', error);
                    $('#submitmsgfailed').text('An error occurred while fetching the data.').show();
                }
            });
        }


        function SubmitDocumentForm(form_id) {
            let allValid = true;
            $(`#${form_id} input[type="file"]`).each(function(index, fileInput) {
                    let file = $(fileInput)[0].files[0];
                    let doc_id = $('#document_cd_' + index).val();
                    let file_url = $('#file_url_' + doc_id).val();
                    let isCompulsory = $('#is_compulsory_' + index).val() == 1;
                    let errorSpan = $('#file_' + doc_id + '-error');
                    let reqFileType = $('#document_type_' + index).val();
                    let allowedFileTypes = [];

                    if (reqFileType == 'image') {
                        allowedFileTypes = ['image/jpg', 'image/jpeg', 'image/png'];
                    } else {
                        allowedFileTypes = ['application/pdf'];
                    }
                    if (file && !allowedFileTypes.includes(file.type)) {
                        errorSpan.text("Invalid file type: Only " + allowedFileTypes.join(', ') +
                            " files are allowed.");
                        allValid = false;
                    } else if (isCompulsory && !file && !file_url) {
                        errorSpan.text('This document is required.');
                        allValid = false;
                    } else if(file){
                        let fileSizeMB = file.size / (1024 * 1024);
                        let maxSizeMB = 2;
                        if (fileSizeMB > maxSizeMB) {
                            errorSpan.text('File size must be less than ' + maxSizeMB + ' MB');
                            allValid = false;
                        } else {
                            errorSpan.text('');
                        }
                    }
                });

                if (allValid) {
                    $('#upload_btn').css('disabled', true);
                    let formElement = $('#shopDocForm')[0];
                    let formData = new FormData(formElement);
                    let Shop_Cd = $('#shop_cd').val();
                    formData.append('Shop_Cd', Shop_Cd);
                    $.ajax({
                        type: "POST",
                        url: "./action/saveShopDocDetails.php",
                        data: formData,
                        processData: false,
                        contentType: false,
                        success: function(response) {
                            var data = JSON.parse(response);
                            if (data.status == 200) {
                                // alert(data.message);
                                $(`#${form_id} #submitmsgsuccess`).html(data.message)
                                    .hide().fadeIn(800, function() {
                                        $("submitmsgsuccess").append("");
                                    }).delay(3000).fadeOut("fast");

                                $('input[name="file[]"]').val('');
                                window.location.href = 'index.php?p=ShopDetalisListOfOwner';
                            } else {
                                $(`#${form_id} #submitmsgfailed`).html(data.message)
                                    .hide().fadeIn(800, function() {
                                        $("submitmsgsuccess").append("");
                                    }).delay(3000).fadeOut("fast");
                            }
                        },
                        error: function(xhr, status, error) {
                            console.log(xhr.responseText);
                        }
                    });
                }
            }

            function validateEmailInput(input) {
                const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                if (input && input.value && !emailRegex.test(input.value)) {
                    input.value = '';
                    $('#shopkeeper_email-error').text("Please enter a valid email.");
                }
            }

            function updateNavLinks() {
                $('.nav-item').each(function() {
                    var tabLink = $(this).find('.nav-link');
                    if ($(this).hasClass('active')) {
                        tabLink.removeClass('disabled');
                        tabLink.attr('aria-disabled', 'false');
                        tabLink.css('pointer-events', '');
                    } else {
                        tabLink.addClass('disabled');
                        tabLink.attr('aria-disabled', 'true');
                        tabLink.css('pointer-events', 'none');
                    }
                });
            }


            function getAmount() {
                var businessdetails = $('#businessdetails').val();
                $.ajax({
                    url: 'action/get_FeesApplicableAmount.php',
                    type: 'POST',
                    data: {
                        ParwanaCd: businessdetails
                    },
                    success: function(response) {
                        var data = JSON.parse(response);
                        var amount = data.Amount;
                        $('#shopfees').val(amount);

                    },
                    error: function() {
                        alert('Error fetching business details.');
                    }
                });

            }

            $('#estimatedate').on('change', function() {
                calculate_ShopOwnsPeriod(this.value);
            });

            function calculate_ShopOwnsPeriod(startDate) {
                if (startDate == null || startDate == '') {
                    $('#ShopOwnPeriod').val("");
                } else {
                    var endDate = new Date();
                    var start = new Date(startDate);
                    var yearsDiff = endDate.getFullYear() - start.getFullYear();
                    var monthsDiff = endDate.getMonth() - start.getMonth();

                    if (endDate.getDate() < start.getDate()) {
                        monthsDiff--;
                    }
                    var totalMonths = yearsDiff * 12 + monthsDiff;

                    $('#ShopOwnPeriod').val(totalMonths);
                }

            }


            $(document).ready(function() {

                $('#ShopModal').modal({
                    backdrop: 'static',
                    keyboard: false
                });

                $('#shopkeeper_mobile').removeAttr('readonly');
                $('#shopkeeper_mobile').on('input', function() {
                    var mobileValue = $(this).val().replace(/[^\d]/g, '').slice(0, 10);
                    setTimeout(() => {
                        if (mobileValue.length == 10 && mobileValue.length != 0) {
                            $('#verifyOtpBtn').show();
                            $('#shopkeeper_mobile-error').text('');
                        } else if (mobileValue.length != 10) {
                            $('#shopkeeper_mobile-error').text('Mobile Number must be 10 digits');
                        } else {
                            $('#verifyOtpBtn').hide();
                        }
                    }, 800);

                });

                $('#shopkeeper_aadharno').on('keyup', function() {
                    var aadharValue = $(this).val().replace(/[^\d]/g, '').slice(0, 12);
                    setTimeout(() => {
                        if (aadharValue.length != 12 && aadharValue.length != 0) {
                            $('#shopkeeper_aadharno-error').text('Aadhar Number must be 12 digits');
                        } else {
                            $('#shopkeeper_aadharno-error').text('');
                        }
                    }, 800);
                });

                $('#shopkeeper_pincode').on('keyup', function() {
                    var pincodeValue = $(this).val().replace(/[^\d]/g, '').slice(0, 6);
                    setTimeout(() => {
                        if (pincodeValue.length != 6 && pincodeValue.length != 0) {
                            $('#shopkeeper_pincode-error').text('Pincode must be 6 digits');
                        } else {
                            $('#shopkeeper_pincode-error').text('');
                        }
                    }, 800);
                });

                $('#shoplength').on('keyup', function() {
                    var lengthValue = $(this).val();
                    setTimeout(() => {
                        if (lengthValue == 0 && lengthValue == '') {
                            $('#shoplength-error').text('Shop Length should be greater than 0');
                        } else {
                            $('#shoplength-error').text('');
                        }
                    }, 800);
                });

                $('#shopwidth').on('keyup', function() {
                    var widthValue = $(this).val();
                    setTimeout(() => {
                        if (widthValue == 0 && widthValue == '') {
                            $('#shopwidth-error').text('Shop width should be greater than 0');
                        } else {
                            $('#shopwidth-error').text('');
                        }
                    }, 800);
                });

                $('#shopheight').on('keyup', function() {
                    var heightValue = $(this).val();
                    setTimeout(() => {
                        if (heightValue == 0 && heightValue == '') {
                            $('#shopheight-error').text('Shop Height should be greater than 0');
                        } else {
                            $('#shopheight-error').text('');
                        }
                    }, 800);
                });


                $('#verifyOtpBtn').on('click', function() {
                    var mobileValue = $('#shopkeeper_mobile').val()
                    var otp = generateOtp();
                    $('#verifyOtpBtn').hide();
                    $('#otpvalue').show();
                    sendOTPToMobileverify(mobileValue, otp);

                });
            });

            function validateMobileNo() {
                var mobileNumber = $('#shopkeeper_mobile').val();
                var otp = $('#otpvalue').val();
                validateOtponpage(mobileNumber, otp)
            }

            function validateOtponpage(mobileNumber, otpEntered) {

                if(otpEntered.length == 4){
                    $.ajax({
                        type: "POST",
                        url: 'action/sendOTP.php',
                        data: {
                            verifyMobileNumber: mobileNumber,
                            verifyOtp: otpEntered
                        },
                        success: function(response) {
                            var responseData = JSON.parse(response);
                            if (responseData.statusCode === 200) {
                                alert("Mobile Verified successfully!!!")
                                $('#shopkeeper_mobile').attr('readonly', true);
                                $('#otpvalue').hide();
                            } else {
                                alert(responseData.msg || 'OTP verification failed.');
                            }
                        },
                        error: function() {
                            alert('Error occurred during OTP verification.');
                        }
                    });
                }

            }

            function sendOTPToMobileverify(mobileNumber, otp) {
                $.ajax({
                    type: "POST",
                    url: 'action/sendOTP.php',
                    data: {
                        mobileNumber: mobileNumber,
                        otp: otp
                    },
                    success: function(response) {
                        response = JSON.parse(response);
                        if (response.statusCode == 200) {
                            alert('OTP has been sent to your mobile number!');
                        } else {
                            alert('Failed to send OTP. Please try again.');
                        }
                    },
                    error: function() {
                        alert('Error occurred while sending OTP.');
                    }
                });
            }

            function generateOtp() {
                var otp = Math.floor(1000 + Math.random() * 9000);
                return otp;
            }
        </script>

     <!-- New Shop Owner Shop Details End -->
</body>

</html>